{
    "title": "streamZ - a video streaming service for LAN",
    "created": 1565621540,
    "updated": 1566584128,
    "author": "Anjan Roy",
    "email": "anjanroy@yandex.com",
    "content": [
        "Won't it be great, if you could run a streaming service on your home PC ?",
        "<br><br>",
        "Yeah like running a video streaming application, leveraging modern web technologies",
        "and watching your favourite videos/ movies <small>( downloaded )</small> on any device",
        "present in LAN as long as it has a modern web browser installed. No doubt downloading is also supported.",
        "<br><br>",
        "<span class='highlight'>streamZ</span> is designed & tested to run on <big>G</big>NU/Linux, cause we'll finally use <span class='highlight'>systemd.service</span>",
        "for keeping this service alive in background. It'll also enable us to start service on boot & restart in case of any unexpected failure.",
        "<br><br>",
        "Start by cloning this repo into your local Linux machine, on which you plan to run this streaming application.",
        "<div class='codeBlock'>",
        "$ cd # getting to home directory",
        "<br>",
        "$ git clone https://github.com/itzmeanjan/streamZ.git",
        "</div>",
        "I'm assuming you've already installed Dart SDK <small>( along with dartaotruntime )</small> on your system.",
        "Haven't yet ?",
        "<br><br>",
        "Follow this guide : <a class='simpleLink' href='https://dart.dev/get-dart' target='_blank'>here</a>",
        "<br><br>",
        "Now update <big>P</big>ATH variable properly so that <span class='highlight'>dartaotruntime</span> can be invoked directly.",
        "<br><br>",
        "Time to run this application.",
        "<div class='codeBlock'>",
        "$ cd bin # assuming you're already at root of project",
        "<br>",
        "$ dartaotruntime main.dart.aot",
        "<br><br>",
        "[+]streamZ_v1.0.0 listening ( streamZ0 ) ...",
        "<br>",
        "</div>",
        "Now open browser & go to URL <span class='highlight'>http://localhost:8000</span>.",
        "<br><br>",
        "You'll see a list of streamable videos, present in your <span class='highlight'>/home/user/Videos/</span>",
        "directory. It'd be better, if I clarify a few limitations this streaming application has.",
        "It can only stream already downloaded <span class='highlight'>mp4</span> & <span class='highlight'>webm</span> videos",
        "present in <span class='highlight'>/home/user/Videos/</span> directory, on machine which is running this application.",
        "So if you've videos in format other than aforementioned formats,",
        "you may consider converting them to any of the supported formats using <big>V</big>LC or something of your choice.",
        "<br><br>",
        "Every 30 minutes a timer will be invoked & changes made in <span class='highlight'>/home/user/Videos/</span>",
        "directory to be collected so that while handling next requests updated playlist can be served.",
        "<br><br>",
        "You may have already found <span class='highlight'>streamZ</span> is written in <big>D</big>art",
        "& one of the greatest things in <big>D</big>art is <big>I</big>solates, which can be thought as light-weight threads, letting us run code in simultaneous fashion",
        "i.e. letting us handle much more requests in an efficient fashion.",
        "Making <big>D</big>art really a great choice for backend.",
        "We'll require to handle many requests at a time because we're planning to",
        "keep this service always running & multiple devices can stream/ download same or",
        "different movies at same time. So we need <big>I</big>solates.",
        "<br><br>",
        "<span class='highlight'>streamZ</span> takes one command line argument, an integer,",
        "denoting number of Isolates to be used for running streamZ, among which load to be distributed.",
        "<div class='codeBlock'>",
        "$ dartaotruntime main.dart.aot 2",
        "<br><br>",
        "[+]streamZ_v1.0.0 listening ( streamZ0 ) ...",
        "<br><br>",
        "[+]streamZ_v1.0.0 listening ( streamZ1 ) ...",
        "<br>",
        "</div>",
        "Time to deploy this application using <span class='highlight'>systemd.service</span>.",
        "<br><br>",
        "You already have a template <span class='highlight'>systemd.service</span> declaration file,",
        "which requires few modifications before we can use it.",
        "<div class='codeBlock'>",
        "$ cd ../systemd/",
        "<br>",
        "$ ls",
        "<br>",
        "streamZ.service",
        "</div>",
        "Open <span class='highlight'>streamZ.service</span> using your favourite text editor",
        "& update <span class='highlight'>User</span> field under <span class='highlight'>[Service]</span>",
        "with your username, which can be found using following command.",
        "<div class='codeBlock'>",
        "$ whoami",
        "</div>",
        "Set <span class='highlight'>WorkingDirectory</span> as absolute path to <small>bin</small>",
        "directory of this project, holding <span class='highlight'>main.dart.aot</span>. Can be found by executing following commands.",
        "<div class='codeBlock'>",
        "$ cd ../bin/",
        "<br>",
        "$ pwd # take this output",
        "</div>",
        "Now you need to find absolute path of installation of <small>dartaotruntime</small>",
        "using following command.",
        "<div class='codeBlock'>",
        "$ whereis dartaotruntime",
        "</div>",
        "If it doesn't return any valid path, may be you've not properly set your <big>P</big>ATH variable.",
        "<br><br>",
        "Update <span class='highlight'>ExecStart</span> field with command to be executed when starting this service,",
        "which is where we need absolute path of installation of <span class='highlight'>dartaotruntime</span> & absolute",
        "path of <span class='highlight'>./bin/main.dart.aot</span>. Consider appending number of <big>I</big>solates you want to use for handling requests.",
        "In template service file you may find, I used two <big>I</big>solates, consider using more/ less as per your requirement.",
        "<br><br>",
        "Keep <span class='highlight'>Restart</span> as <small>always</small>, so that if some unexpected error occurs and service gets stopped, it'll be auto started by <small>systemd</small>.",
        "Now <span class='highlight'>streamZ.service</span> is okay.",
        "<br><br>",
        "Copy it into <span class='highlight'>/etc/systemd/system/</span> using following command.",
        "<div class='codeBlock'>",
        "$ sudo cp streamZ.service /etc/systemd/system/ -v",
        "</div>",
        "Now we need to reload systemd daemon so that it can find this newly added service file.",
        "<div class='codeBlock'>",
        "$ sudo systemctl daemon-reload",
        "</div>",
        "We'll first enable this service, which will ensure it starts automatically after each boot, using following command.",
        "<div class='codeBlock'>",
        "$ sudo systemctl enable streamZ.service",
        "</div>",
        "And finally start this service so that, our streaming service becomes available for use in LAN.",
        "<div class='codeBlock'>",
        "$ sudo systemctl start streamZ.service",
        "</div>",
        "You can check status of this service using following command.",
        "<div class='codeBlock'>",
        "$ sudo systemctl status streamZ.service",
        "</div>",
        "Consider opening <span class='highlight'>http://private-ip-of-this-machine:8000</span>",
        "from some other device with a modern web browser, present in LAN.",
        "And you'll be landed into streamZ playList, where you can select a certain movie and start streaming it.",
        "<br><br>",
        "If you want to download a movie instead of streaming it, try selecting <span class='highlight'>cancel</span>",
        "from confirmation popup, which will initiate a download of selected movie.",
        "<br><br>",
        "Consider going through code <small>( which is pretty well documented )</small>",
        "for getting deeper insight into implementation.",
        "<br><br>",
        "Source code of streamZ : <a target='_blank' class='simpleLink' href='https://github.com/itzmeanjan/streamZ'>here</a>",
        "<br><br>",
        "Encountered some unexpected issue, consider letting me know <big>&#x1f600</big>.",
        "<br><br>",
        "Well that's it. Hope to see you in another post ;)"
    ]
}